#!/bin/bash

if [ $# != 2 ]; then
  echo 'usage: $0 root version'
  exit
else
  ALLIN1=$1
  VERSION=$2
  rm -f ${ALLIN1}.css ${ALLIN1}.js
  touch ${ALLIN1}.css ${ALLIN1}.js
fi

echo "/* JS9 allinone: v${VERSION} */" >> ${ALLIN1}.js
cat js9support.min.js js9.min.js js9plugins.js astroem.js >> ${ALLIN1}.js

echo 'JS9.allinone = {};' >> ${ALLIN1}.js
echo 'JS9.allinone.min = "data:image/gif;base64,R0lGODlhEAAOAPcAAAQCBISChNTSzERCRPz+/B+a/wCD/wB8/z8I7hz//wCA/wB8/wD/AAD/ABX/AAD/AAkF8AD/AACAeQB8AAADAgIoAABCAAAAAAAQ9AMgAAAWAAAAAKDWKeXyAhLVAAB3AOk/3OVHAoFIAHwAAABmrAAGAgESAAAAAFYB9AAAAAAAAAAAAKgAKeQAAhIAAAAAAG4W3AAKAgABAAADAMgBrOUAAhIAAAAAABgABu4AAZAAAHwAAHAAFQUAApEAAHwAAP/kyv8BAv8AAP8AAG1QmgUAApEAAHwAAIUA8ecAAIEAAHwAAAAAKQAAAhUAAAAAAGCArAMf5wAAEgAAALAj24kAvyAA1AAAd7hs8GF4ABX3eQC0AABo8QCFAACAKQC/An5QuABjBACMBsDhAAAIMAABgAAARQAAAP9/AP8CAP8gAP8BAP8Alv8An//8Of8FdgA6IAA8RwA6FQB2AAAgAAAAAAAAAAAAAABmqAAG5xUSEgAAAHwSYIYAngAAgAACfNgAEOUAIBIAFgAAAJ8AAOsAAIEAAHwAAErkB+MBAIEAAHwAAEBQAOUAAE8AAAAAALggAGEAIAEAFgAAAGxmAAAGAAASAAAAABR8AOWGABIAAAAAADTwAADmAAASAMAAAPiFAPcrABKDAAB8ABgAaO4AnpAAgHwAfHAA/wUA/5EA/3wA//8AYP8Anv8AgP8AfG0AEQUBAJEAAHwAAErpEfQrAICDAHx8AAAUXADn8BUSEgAAAADE/wAr/wCD/wB8/7gAAGEAABUAAAAAAAAQHAEg6AAWEgAAAAA0DgBkzwCDSwB8AFf//PT/54D/Enz/AAAYW+fo4hISTgAAALhtMGFk6BWDEgB8ALi4NOnvZBJOgwAAfAAQrQAZ6ABPEgAAAOQA7QEB/wAA/wAAfxAUnCDn6BYSEgAAAFAAEAABIAAAFgAAAA6INABkZACDgwB8fO4BEOYAIBIAFgAAAAEAfAAAhgAAAAAAAABwAObnABISAAAAAKC/fubPVRLVRwB3ACH5BAAAAAAALAAAAAAQAA4ARwhFAAkIHEiw4AACAhIqXKgwwEGGEBM6JBCgosWLFx9GZDhxI0eNAgCIHLmwo8eGIE+aPClgpUqQI0miRMiy5YCbOHPqvBkQADs=";' >> ${ALLIN1}.js

echo 'JS9.allinone.close = "data:image/gif;base64,R0lGODlhEAAOAKIAAAAAAGNjY3t7e5ycnL29vcbGxt7e3v///yH5BAAAAAAALAAAAAAQAA4AAANCeLrccybKKUWAJOudLSYAsIVE4RkaWZDdhRZZyJYnx8JEna3yVsOsm24GEuVcHJzGhNwlWweBdEqlBgqDrHa7LSQAADs=";' >> ${ALLIN1}.js

echo 'JS9.allinone.restore = "data:image/gif;base64,R0lGODlhEAAOAKIAAAAAAGNjY3t7e5ycnL29vcbGxt7e3v///yH5BAAAAAAALAAAAAAQAA4AAANCeLrccybKKUWAJIPNM7GYxm1ZARpEQQDe6p3ryLIpLM/vhdIibeouDy9jKwVVH+CtlQwxjU2BdEqlBgqDrHa7LSQAADs=";' >> ${ALLIN1}.js

echo 'JS9.allinone.resize = "data:image/gif;base64,R0lGODlhDQANAPcAAISChNTSzPz+/AB8AGlwyB+ZWgCAeQB8AGL/GBz/5wD/EgD/AABtAACZABWAAAB8AAnaAACi6AA+EgB3AACYZwJRBAAa1wAAdwC+VAOU5wDUEgB3AKAtmOW01RLU1AB3d+nExOUDA4FAQHwAAAAghAAAAAEAAAAAAFbuAAAEAAAgAAAAAKgSxOQAARIAtgACAW4AAQAAAAAAAAAAAMierOUC5xIAEgAAABgB9u4AGpAA13wAWnDExAUDA5FAQHwAAP8whP+AAP9FAP8AAG3uAAUEAJEgAHwAAIUAxOcAAYEAtnwAAQAAxAAAAxUAQAAAAGBQMAMWgAAARQAAABABAAIAAB4AAAAAALjQbWEHRRUARQAAAAAAkAAAHAAATwAAAH5IcAAyHAAVT8AAAAAApAAA7AAAEgAAAP+kXP/m8v8SEv8AAP+YMP/VgP/URf93AADEIAAD8gBAEgAAAAAgAAAAAAAAAAAAAADuMAAEgBUgRQAAANYCYB4AngAAgAAAfNj8EOXm/xISFQAAAJ/8AOvmAIESAHwAAEqCB+PPAIHVAHx3AEDkAOXmAE8SAAAAALjEAGEB8AEAFQAAAGwFAAAAAAAAAAAAABTWAOUeABIAAAAAADTwAADmAAASAMAAAPiFAPcrABKDAAB8ABgAaO4AnpAAgHwAfHAA/wUA/5EA/3wA//8AYP8Anv8AgP8AfG0AFAUBAJEAAHwAAErpFPQrAICDAHx8AAAUXADn8BUSEgAAAADE/wAr/wCD/wB8/7gAAGEAABUAAAAAAAAQHAH/6AAVEgAAAAA0DgBkzwCDSwB8AFf//PT/54D/Enz/AAAYW+fo4hISTgAAALhtMGFk6BWDEgB8AJi4NFHvZBpOgwAAfAAQsOcZ6BJPEgAAAAAA6ucB/xIA/wAAfwAUnADn6AASEgAAAAEAEAAB/wAAFQAAABCINOdkZBKDgwB8fP8BEP8A//8AFf8AAPgA1uUAHhIAAAAAAAEzAAC5AADUAAB3AECYfvA6VRIzRwAAACH5BAEAAAEALAAAAAANAA0ARwg4AAMIHEhQoACCAgAACJBw4cGCBhUyhEixYsSFBRsylLjRoUSNFjdaBAlRY8KMHzle7CjSZMqFAQEAOw==";' >> ${ALLIN1}.js

echo "JS9.allinone.regionsConfigHTML = \"`cat params/regionsconfig.html | sed '1,/<body>/d;/<\/body>/,$d' | sed 's/"/\\\\"/g' | tr -d '\n'`\";" >> ${ALLIN1}.js

echo "JS9.allinone.regionsConfigHTML = \"`cat params/regionsconfig.html | sed '1,/<body>/d;/<\/body>/,$d' | sed 's/"/\\\\"/g' | tr -d '\n'`\";" >> ${ALLIN1}.js

echo "JS9.allinone.loadCorsHTML = \"`cat params/loadcors.html | sed '1,/<body>/d;/<\/body>/,$d' | sed 's/"/\\\\"/g' | tr -d '\n'`\";" >> ${ALLIN1}.js

echo "JS9.allinone.datapathHTML = \"`cat params/datapath.html | sed '1,/<body>/d;/<\/body>/,$d' | sed 's/"/\\\\"/g' | tr -d '\n'`\";" >> ${ALLIN1}.js

echo "/* JS9 allinone: v${VERSION} */" >> ${ALLIN1}.css
cat js9support.css js9.css >> ${ALLIN1}.css

echo '.context-menu-icon-sun:before{content: url("data:image/png;base64,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");}' >> ${ALLIN1}.css
